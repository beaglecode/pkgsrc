$NetBSD: patch-CVE-2013-4852-2,v 1.1 2013/08/06 12:23:37 drochner Exp $

--- sshrsa.c.orig	2011-02-18 08:25:39.000000000 +0000
+++ sshrsa.c
@@ -526,6 +526,8 @@ static void getstring(char **data, int *
     if (*datalen < 4)
 	return;
     *length = GET_32BIT(*data);
+    if (*length < 0)
+	return;
     *datalen -= 4;
     *data += 4;
     if (*datalen < *length)
