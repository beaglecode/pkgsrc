# $NetBSD: Makefile,v 1.7 2013/07/18 11:59:28 sborrill Exp $
#

VERSION=	6.2.0
DISTNAME=	XenServer-${VERSION}-SDK
PKGNAME=	libxenserver-${VERSION}
CATEGORIES=	devel
MASTER_SITES=	http://downloadns.citrix.com.edgesuite.net/7289/

MAINTAINER=	sborrill@NetBSD.org
HOMEPAGE=	http://community.citrix.com/cdn/xs/sdks/
COMMENT=	Citrix XenServer SDK for C
LICENSE=	gnu-gpl-v2

EXTRACT_SUFX=	.zip
WRKSRC=		${WRKDIR}/XenServer-SDK/libxenserver/src
MAJOR=		2
MINOR=		0
BUILD_TARGET=	libxenserver.so
USE_TOOLS+=	gmake pax

PLIST_SUBST+=	MAJOR=${MAJOR:Q} MINOR=${MINOR:Q}

INSTALLATION_DIRS=	include/xen/api
INSTALLATION_DIRS+=	share/examples/libxenserver lib

do-install:
	${INSTALL_LIB} ${WRKSRC}/libxenserver.so.${MAJOR}.${MINOR} ${DESTDIR}${PREFIX}/lib
	${INSTALL_LIB} ${WRKSRC}/libxenserver.so ${DESTDIR}${PREFIX}/lib
	cd ${WRKSRC}/include/xen/api && pax -rw *.h ${DESTDIR}${PREFIX}/include/xen/api
.for example in test_event_handling.c test_failures.c test_vm_ops.c
	${INSTALL_DATA} ${WRKSRC}/test/${example} \
	    ${DESTDIR}${PREFIX}/share/examples/libxenserver
.endfor

.include "../../mk/bsd.prefs.mk"

.include "../../textproc/libxml2/buildlink3.mk"
.include "../../www/curl/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
